<!DOCTYPE html><html lang="zh-TW" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>選擇權策略開發-缺乏歷史價格的挑戰 | 選擇權超人</title><meta name="author" content="OptionSuperman"><meta name="copyright" content="OptionSuperman"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="🤔歷史資料缺失問題在做量化策略的時候，歷史資料一直是在回測上很重要的基礎，但當你爬了期交所公開資料下來準備寫選擇權交易策略時，會發現一個令人心碎的事實：歷史數據中很常都沒有價格！ 選擇權價格受多種因素影響，包括履約價、到期日、市場波動性…等。 但在量化分析上最令人頭疼的是，並非所有的選擇權都像熱門股票那樣，時時刻刻都有買賣。 有些選擇權可能只有零星的交易，或者根本沒有交易。這就是為什麼，當你試圖"><meta property="og:type" content="article"><meta property="og:title" content="選擇權策略開發-缺乏歷史價格的挑戰"><meta property="og:url" content="https://blog.optionsuperman.com/posts/option-historical-prices-problem/index.html"><meta property="og:site_name" content="選擇權超人"><meta property="og:description" content="🤔歷史資料缺失問題在做量化策略的時候，歷史資料一直是在回測上很重要的基礎，但當你爬了期交所公開資料下來準備寫選擇權交易策略時，會發現一個令人心碎的事實：歷史數據中很常都沒有價格！ 選擇權價格受多種因素影響，包括履約價、到期日、市場波動性…等。 但在量化分析上最令人頭疼的是，並非所有的選擇權都像熱門股票那樣，時時刻刻都有買賣。 有些選擇權可能只有零星的交易，或者根本沒有交易。這就是為什麼，當你試圖"><meta property="og:locale" content="zh_TW"><meta property="og:image" content="https://github.com/opsuperman/picx-images-hosting/raw/master/%E9%81%B8%E6%93%87%E6%AC%8A%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC-%E7%BC%BA%E4%B9%8F%E6%AD%B7%E5%8F%B2%E5%83%B9%E6%A0%BC%E7%9A%84%E6%8C%91%E6%88%B0/%E6%AD%B7%E5%8F%B2%E5%83%B9%E6%A0%BC%E8%AD%A6%E7%A4%BA.j1ityqv1y2w.webp"><meta property="article:published_time" content="2023-10-26T09:57:00.000Z"><meta property="article:modified_time" content="2023-11-30T04:25:41.632Z"><meta property="article:author" content="OptionSuperman"><meta property="article:tag" content="選擇權"><meta property="article:tag" content="程式交易"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://github.com/opsuperman/picx-images-hosting/raw/master/%E9%81%B8%E6%93%87%E6%AC%8A%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC-%E7%BC%BA%E4%B9%8F%E6%AD%B7%E5%8F%B2%E5%83%B9%E6%A0%BC%E7%9A%84%E6%8C%91%E6%88%B0/%E6%AD%B7%E5%8F%B2%E5%83%B9%E6%A0%BC%E8%AD%A6%E7%A4%BA.j1ityqv1y2w.webp"><link rel="shortcut icon" href="https://raw.githubusercontent.com/opsuperman/picx-images-hosting/master/main_website/Favicon_8080.webp"><link rel="canonical" href="https://blog.optionsuperman.com/posts/option-historical-prices-problem/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script async src="https://www.googletagmanager.com/gtag/js?id=G-KP88T9ZY6S"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KP88T9ZY6S")</script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,top_n_per_article:1,unescape:!1,languages:{hits_empty:"找不到您查詢的內容：${query}",hits_stats:"共找到 ${hits} 篇文章"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"複製成功",error:"複製錯誤",noSupport:"瀏覽器不支援"},relativeDate:{homepage:!1,post:!1},runtime:"",dateSuffix:{just:"剛剛",min:"分鐘前",hour:"小時前",day:"天前",month:"個月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js",buttonText:"載入更多"},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"選擇權策略開發-缺乏歷史價格的挑戰",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-11-30 12:25:41"}</script><script>(e=>{e.saveToLocal={set:(e,t,o)=>{if(0===o)return;const a={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(a))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},Object.keys(t).forEach(e=>{n.setAttribute(e,t[e])}),document.head.appendChild(n)}),e.getCSS=(e,t=!1)=>new Promise((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},document.head.appendChild(n)}),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://raw.githubusercontent.com/opsuperman/picx-images-hosting/master/main_website/icon_110110.webp" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">3</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 文章分類</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image:url(https://github.com/opsuperman/picx-images-hosting/raw/master/選擇權策略開發-缺乏歷史價格的挑戰/歷史價格警示.j1ityqv1y2w.webp)"><nav id="nav"><span id="blog-info"><a href="/" title="選擇權超人"><span class="site-name">選擇權超人</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i><span> 搜尋</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 文章分類</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">選擇權策略開發-缺乏歷史價格的挑戰</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">發表於</span><time class="post-meta-date-created" datetime="2023-10-26T09:57:00.000Z" title="發表於 2023-10-26 17:57:00">2023-10-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新於</span><time class="post-meta-date-updated" datetime="2023-11-30T04:25:41.632Z" title="更新於 2023-11-30 12:25:41">2023-11-30</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%81%B8%E6%93%87%E6%AC%8A%E7%A8%8B%E5%BC%8F%E4%BA%A4%E6%98%93/">選擇權程式交易</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="🤔歷史資料缺失問題"><a href="#🤔歷史資料缺失問題" class="headerlink" title="🤔歷史資料缺失問題"></a>🤔歷史資料缺失問題</h2><p>在做量化策略的時候，歷史資料一直是在回測上很重要的基礎，但當你爬了期交所公開資料下來準備寫選擇權交易策略時，會發現一個令人心碎的事實：歷史數據中很常都沒有價格！</p><p>選擇權價格受多種因素影響，包括履約價、到期日、市場波動性…等。</p><p>但在量化分析上最令人頭疼的是，並非所有的選擇權都像熱門股票那樣，時時刻刻都有買賣。</p><p>有些選擇權可能只有零星的交易，或者根本沒有交易。這就是為什麼，當你試圖撈取歷史數據時，會發現某些時段的數據是缺失的。</p><p>這樣的情況下，如何做選擇權的回測呢？在這篇文章中，我們會深入探討這一棘手的問題，並揭示我們是如何一步步解決它的。</p><h2 id="選擇權策略案例"><a href="#選擇權策略案例" class="headerlink" title="選擇權策略案例"></a>選擇權策略案例</h2><blockquote><p>舉個實例: 假設你有一隻一分K月選策略想在2021&#x2F;11&#x2F;22 23:17:00 用履約價18400進場sell put，並且在2021&#x2F;11&#x2F;23 00:57:00出場</p></blockquote><p><img src="https://github.com/opsuperman/picx-images-hosting/raw/master/%E9%81%B8%E6%93%87%E6%AC%8A%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC-%E7%BC%BA%E4%B9%8F%E6%AD%B7%E5%8F%B2%E5%83%B9%E6%A0%BC%E7%9A%84%E6%8C%91%E6%88%B0/multicharts%E7%AD%96%E7%95%A5%E7%AF%84%E4%BE%8B%E5%9C%96.su0vfphd3q8.webp" alt="multicharts策略範例圖" title="multicharts策略範例圖"></p><p>第一步就要去找歷史資料這兩個時間點的價格，會發現期交所原始資料18400 Put 11&#x2F;12下午盤到11&#x2F;23開盤這時間有的成交價格資料就只有藍色區塊這幾筆。</p><p><img src="https://github.com/opsuperman/picx-images-hosting/raw/master/%E9%81%B8%E6%93%87%E6%AC%8A%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC-%E7%BC%BA%E4%B9%8F%E6%AD%B7%E5%8F%B2%E5%83%B9%E6%A0%BC%E7%9A%84%E6%8C%91%E6%88%B0/%E5%8E%9F%E5%A7%8B%E5%83%B9%E6%A0%BC%E8%B3%87%E6%96%99.2ag7pihjsgpw.webp" alt="原始價格資料" title="原始價格資料"></p><h2 id="淺談補選擇權價格缺值方法"><a href="#淺談補選擇權價格缺值方法" class="headerlink" title="淺談補選擇權價格缺值方法:"></a>淺談補選擇權價格缺值方法:</h2><p>用剛剛的策略例子，當你決定進場交易，突然發現沒有資料可供參考。</p><p><strong>進場時間的原始資料</strong></p><table><thead><tr><th align="center">日期</th><th align="center">時間</th><th align="center">履約價</th><th align="center">PUT價格</th></tr></thead><tbody><tr><td align="center">2021&#x2F;11&#x2F;22</td><td align="center">23:17:00</td><td align="center">18400</td><td align="center">無</td></tr></tbody></table><p><strong>出場時間的原始資料</strong></p><table><thead><tr><th align="center">日期</th><th align="center">時間</th><th align="center">履約價</th><th align="center">PUT價格</th></tr></thead><tbody><tr><td align="center">2021&#x2F;11&#x2F;23</td><td align="center">00:57:00</td><td align="center">18400</td><td align="center">無</td></tr></tbody></table><p>當發現都沒有put的價格資料，通常第一個直覺就是去內外插，或是往前找(ffill)或往後找(bfill)價格</p><p><strong>假設我們採用往後的方式:</strong></p><p>進場價格就是 : 570</p><p>出場價格就是 : 705</p><p><strong>假設我們採用往前的方式:</strong></p><p>進場價格就是 : 590</p><p>出場價格就是 : 570</p><p>報酬很明顯有很大的落差，一個賺錢另一個變成賠錢，因此怎麼回補缺值數據是一個需要仔細研究的事。</p><p>我們先看早盤靠近價平附近的原始價格，比如早盤履約價17700的Put原始價格</p><p><img src="https://github.com/opsuperman/picx-images-hosting/raw/master/%E9%81%B8%E6%93%87%E6%AC%8A%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC-%E7%BC%BA%E4%B9%8F%E6%AD%B7%E5%8F%B2%E5%83%B9%E6%A0%BC%E7%9A%84%E6%8C%91%E6%88%B0/%E6%97%A9%E7%9B%A417700%E5%83%B9%E6%A0%BC%E5%8E%9F%E5%A7%8B.5023kdfpqvw0.webp" alt="早盤17700 put價格原始資料" title="早盤17700 put價格原始資料"></p><p>我們也把微笑曲線畫出來，隨便挑某一分鐘來看，會看到其實缺很多價格<br><img src="https://github.com/opsuperman/picx-images-hosting/raw/master/%E9%81%B8%E6%93%87%E6%AC%8A%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC-%E7%BC%BA%E4%B9%8F%E6%AD%B7%E5%8F%B2%E5%83%B9%E6%A0%BC%E7%9A%84%E6%8C%91%E6%88%B0/%E6%97%A9%E7%9B%A4%E5%8E%9F%E5%A7%8BStrikeIV%E5%9C%96.5af6g750b5g0.webp" alt="早盤微笑曲線" title="早盤微笑曲線"></p><h3 id="如何修正這些缺口？答案可能要從隱含波動率和選擇權模型的方法著手"><a href="#如何修正這些缺口？答案可能要從隱含波動率和選擇權模型的方法著手" class="headerlink" title="如何修正這些缺口？答案可能要從隱含波動率和選擇權模型的方法著手"></a>如何修正這些缺口？答案可能要從隱含波動率和選擇權模型的方法著手</h3><p>通常選擇權要模擬數據，會先使用沒有缺失的部分，也就是僅有的一些數據算出已知的隱含波動率。</p><p>接下來就是利用一些模型或是機器學習去Fit參數，想辦法作出可能的價格走勢。</p><p>如下圖所示，藍色實線是原始的歷史價格，而我用橘色虛線表示我們算出來的預估價格，我們把剛剛的履約價17700的Put缺失的價格部分填滿，而當我們建立出一個可以用的連續價格走勢，接下來就比較可以好好的開始寫策略進行回測。</p><p><img src="https://github.com/opsuperman/picx-images-hosting/raw/master/%E9%81%B8%E6%93%87%E6%AC%8A%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC-%E7%BC%BA%E4%B9%8F%E6%AD%B7%E5%8F%B2%E5%83%B9%E6%A0%BC%E7%9A%84%E6%8C%91%E6%88%B0/%E6%97%A9%E7%9B%A417700%E6%AF%94%E8%BC%83%E5%9C%96.44w70m1jaq6.webp" alt="早盤17700比較圖" title="早盤17700比較圖"></p><p>不過建立的模型也有很多不同的方式，筆者試過多種不同方法，但每個方法推估出來的數字都會因為選擇的模型與輸入的模型參數跟訓練的方法而有不同，因此計算出來的價格也會不同。</p><h3 id="對估計值的理解"><a href="#對估計值的理解" class="headerlink" title="對估計值的理解"></a>對估計值的理解</h3><p><strong>因此要知道只要是有缺失的價格，算出來的估計價格其實並不精確</strong>，不同人算出來的也會不同，因為沒有價格資料的歷史就沒有辦法去對標準答案了。</p><p>不過因為回測需要這些價格，因此 <strong>價格有值參考總比沒有值參考好</strong></p><p>在回測上，有值來參考至少還可以回測，不然也回測不了，只是要注意他只是估計的理論值。</p><p>回到剛剛的策略，履約價18400 整個滿滿都是缺失值，幾乎看不到原始歷史價格的藍線，我畫出來幾乎是完全空白，而透過前面訓練出來的模型，就可以去做出18400的估計價格</p><p>下圖是18400 put 夜盤的估計價格走勢圖:</p><p><img src="https://github.com/opsuperman/picx-images-hosting/raw/master/%E9%81%B8%E6%93%87%E6%AC%8A%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC-%E7%BC%BA%E4%B9%8F%E6%AD%B7%E5%8F%B2%E5%83%B9%E6%A0%BC%E7%9A%84%E6%8C%91%E6%88%B0/%E4%B8%8B%E5%8D%88%E7%9B%A418400put%E5%83%B9%E6%A0%BC.35odlgn2sew0.webp" alt="下午盤18400put價格" title="下午盤18400put價格"></p><p>雖然有時候我們也很難知道到底這樣算出來的價格到底誤差多少，</p><p>不過如果我們去對應相同時間期貨的走勢，正常來講put的圖形應該會跟台指期的漲跌呈現一種反向的關西</p><p><img src="https://github.com/opsuperman/picx-images-hosting/raw/master/%E9%81%B8%E6%93%87%E6%AC%8A%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC-%E7%BC%BA%E4%B9%8F%E6%AD%B7%E5%8F%B2%E5%83%B9%E6%A0%BC%E7%9A%84%E6%8C%91%E6%88%B0/%E5%B0%8D%E6%87%89%E5%8F%B0%E6%8C%87%E6%9C%9F%E8%B5%B0%E5%8B%A2%E5%9C%96.3pjtezuenic0.webp" alt="對應台指期走勢圖" title="對應台指期走勢圖"></p><p>從上圖就可以看得出來，對應的時間確實有一種反向的關西。</p><p>所以剛剛那支進場sell put的策略，我們就可以有一點點依據，這邊剛好是put漲了一段，所以我們可以計算這筆交易可能會賺賠多少了。</p><h2 id="實用工具-選擇權超人回測平台"><a href="#實用工具-選擇權超人回測平台" class="headerlink" title="實用工具-選擇權超人回測平台"></a>實用工具-選擇權超人回測平台</h2><p>當然處理複雜的資料是很惱人的，不過好消息是選擇權超人的回測平台有盡可能的把資料給整理起來，如果不想自己處理資料，可以參考使用這個工具，讓你簡單運用multicharts就可以讓你更快速的開發選擇權策略。</p><div class="btn-center" style="margin-top:20px;margin-bottom:20px"><a class="btn-beautify outline center orange larger" href="https://blog.optionsuperman.com/posts/options-trading-backtesting-guide/" title="關於回測平台的使用介紹"><i class="far fa-hand-point-right"></i><span>關於回測平台的使用介紹</span></a></div><h2 id="📌選擇權策略開發要點："><a href="#📌選擇權策略開發要點：" class="headerlink" title="📌選擇權策略開發要點："></a>📌選擇權策略開發要點：</h2><p>而因為很多缺失值，所以有幾個在開發策略上關於缺失值的部分跟大家分享。<br>第一個就是</p><h3 id="1-避開下午剛開盤"><a href="#1-避開下午剛開盤" class="headerlink" title="1.避開下午剛開盤"></a>1.避開下午剛開盤</h3><p>這是未填入估計值的原始資料，下午三點剛開盤的前幾分鐘，我們隨便找一天的一分K，如圖，這一分鐘內幾乎都是沒有價格的狀態(NaN表示沒價格)。<br><img src="https://github.com/opsuperman/picx-images-hosting/raw/master/%E9%81%B8%E6%93%87%E6%AC%8A%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC-%E7%BC%BA%E4%B9%8F%E6%AD%B7%E5%8F%B2%E5%83%B9%E6%A0%BC%E7%9A%84%E6%8C%91%E6%88%B0/%E4%B8%8B%E5%8D%88%E4%B8%89%E9%BB%9E%E5%89%9B%E9%96%8B%E7%9B%A4.4v9l8sbufe60.webp" alt="選擇權下午三點剛開盤價格" title="選擇權下午三點剛開盤價格"></p><h3 id="2-不要使用太多深價內或深價外"><a href="#2-不要使用太多深價內或深價外" class="headerlink" title="2.不要使用太多深價內或深價外"></a>2.不要使用太多深價內或深價外</h3><p>價平附近因為資料點足夠多，所以大部分不同的預估方法算出來的價格比較不會差太多。</p><p>即使經過填補，仍建議在策略開發中避免使用沒有價格的區域，會有估計值比例比較高的問題。</p><p>比如出場獲利很大的一大段就會很容易用到很遠的履約價價格，或是進場用了很深價內或是價外的值做進場。</p><h3 id="3-注意使用估計值的比例與完全缺失的比例"><a href="#3-注意使用估計值的比例與完全缺失的比例" class="headerlink" title="3.注意使用估計值的比例與完全缺失的比例"></a>3.注意使用估計值的比例與完全缺失的比例</h3><p>在選擇權超人回測績效報告上，我們有把所有交易的價格是使用理論預估值的比例列出來，<br>比如你有500筆進場跟500筆出場，而裡面有100筆價格不是真實的歷史價格而是理論的預估值，那這個比例就是10%</p><p>這樣你就知道你這支策略是不是用了太多的價格都是估計值，這個比例越高，回測出來的績效越不準確。</p><p>而同樣的，有些地方是真的沒有資料，並且非常難以補到的，我們也會列出來他占你交易的比例多少。<br>當抓不到價格，我們回測時會跳過計算這筆交易。</p><p>像下圖雖然我做出一隻風報比不錯的策略，但是估計值的比例高到82.2%，表示我進出場可能使用到非常多的深度價內或價外的價格，因此我會知道他回測出來的績效可能要打很大的折扣，這支策略可能不那麼穩定。</p><p><img src="https://github.com/opsuperman/picx-images-hosting/raw/master/%E9%81%B8%E6%93%87%E6%AC%8A%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC-%E7%BC%BA%E4%B9%8F%E6%AD%B7%E5%8F%B2%E5%83%B9%E6%A0%BC%E7%9A%84%E6%8C%91%E6%88%B0/%E6%8E%A1%E7%94%A8%E7%90%86%E8%AB%96%E5%83%B9%E6%AF%94%E4%BE%8B.flk1stkm4qg.webp" alt="採用理論價比例" title="採用理論價比例"></p><h2 id="歷史回測的新理解-理論價格的藝術與科學"><a href="#歷史回測的新理解-理論價格的藝術與科學" class="headerlink" title="歷史回測的新理解-理論價格的藝術與科學"></a>歷史回測的新理解-理論價格的藝術與科學</h2><p>做策略的開發猶如從歷史資料中尋找智慧與寶藏。在這個過程中，像極了對過去考古題的解讀與探索，並且期待透過過往的歷史經驗，預測未知的未來。</p><p>在期貨或股票的回測中，量化開發者很習慣要求資料的完整性，不允許缺失或不確定性。</p><p>因為資料的準確性是量化分析成功的關鍵之一。然而，當我們深入選擇權的世界，這種想法卻受到了挑戰。在這裡，歷史一旦成為過去，某些資料的缺失是無法逆轉的事實。面對這樣的現實，我們得學會自己去設計與填補那些空白，創造一個完整的歷史理論資料。</p><p>理論價格，從本質上來看，就是一種估計值，它與實際價格之間存在著固有的誤差。這誤差的大小，也是可以深入研究的主題了。沒有絕對的答案，只有逼近真實的技巧。</p><p>在此，我們也誠摯地歡迎所有的高手，一同交流與指教有沒有更準確的作法，或者對我們計算出來的價格提出質疑，讓我們有更好的改進空間，也可以一起探討如何能更加接近那真實的價格之方法。</p><h2 id="總結"><a href="#總結" class="headerlink" title="總結:"></a>總結:</h2><p>在進行選擇權策略的開發時，<font color="#008000">盡量注意估計值比例，避開剛開盤或是冷門交易時間的進出場</font>，這樣回測起來會比較貼近真實歷史價格狀況。</p><p>如果你不想處理繁瑣的資料可以使用選擇權超人的回測工具，此工具已經為你解決了資料缺失的困擾，且巧妙地填補了各種缺失的價格，並且讓你輕鬆用multicharts原本開發台指期交易策略的方式，就可以回測多種選擇權策略</p><div class="btn-center" style="margin-top:60px;margin-bottom:60px"><a class="btn-beautify outline center blue larger" target="_blank" rel="noopener external nofollow noreferrer" href="https://bit.ly/3Swrkbh" title="歡迎加入我們的交流討論群"><i class="far"></i><span>歡迎加入我們的交流討論群</span></a></div><hr><div class="note warning flat"><p>資料來源:期交所公開資料<br>免責申明:投資有賺有賠，僅分享量化研究與過去歷史統計數據，不保證資料或結果之正確性，量化策略也都很容易有時效性，內容和意見僅供參考，並不構成投資建議或勸誘，請勿直接串接下單。讀者應當自行進行完整的研究，並在做出任何投資決策前，理性評估，為自己負責。</p></div></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%81%B8%E6%93%87%E6%AC%8A/">選擇權</a><a class="post-meta__tags" href="/tags/%E7%A8%8B%E5%BC%8F%E4%BA%A4%E6%98%93/">程式交易</a></div><div class="post_share"><div class="social-share" data-image="https://github.com/opsuperman/picx-images-hosting/raw/master/選擇權策略開發-缺乏歷史價格的挑戰/歷史價格警示.j1ityqv1y2w.webp" data-sites="facebook,twitter"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/just-buy-call/" title="簡單長期Buy Call策略分析"><img class="cover" src="https://github.com/opsuperman/picx-images-hosting/raw/master/簡單長期Buy-Call策略分析/封面.22948brzik1s.webp" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">簡單長期Buy Call策略分析</div></div></a></div><div class="next-post pull-right"><a href="/posts/options-trading-backtesting-guide/" title="如何程式交易選擇權-回測篇"><img class="cover" src="https://github.com/opsuperman/picx-images-hosting/raw/master/如何程式交易選擇權/回測選擇權的機器人工具.qiff3jnwb1s.webp" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">如何程式交易選擇權-回測篇</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相關推薦</span></div><div class="relatedPosts-list"><div><a href="/posts/options-trading-backtesting-guide/" title="如何程式交易選擇權-回測篇"><img class="cover" src="https://github.com/opsuperman/picx-images-hosting/raw/master/如何程式交易選擇權/回測選擇權的機器人工具.qiff3jnwb1s.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-25</div><div class="title">如何程式交易選擇權-回測篇</div></div></a></div><div><a href="/posts/3742663632/" title="選擇權履約價種類"><img class="cover" src="https://raw.githubusercontent.com/opsuperman/picx-images-hosting/master/履約價種類/workspace-gb3c1af57c_1920.7715chvcyuc0.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-31</div><div class="title">選擇權履約價種類</div></div></a></div><div><a href="/posts/1564230905/" title="現貨，期貨，與選擇權差別"><img class="cover" src="https://raw.githubusercontent.com/opsuperman/picx-images-hosting/master/現貨期貨選擇權差別/第一章圖.9ali0ml7n9w.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-06</div><div class="title">現貨，期貨，與選擇權差別</div></div></a></div><div><a href="/posts/just-buy-call/" title="簡單長期Buy Call策略分析"><img class="cover" src="https://github.com/opsuperman/picx-images-hosting/raw/master/簡單長期Buy-Call策略分析/封面.22948brzik1s.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-28</div><div class="title">簡單長期Buy Call策略分析</div></div></a></div><div><a href="/posts/146350275/" title="選擇權簡介"><img class="cover" src="https://raw.githubusercontent.com/opsuperman/picx-images-hosting/master/選擇權簡介/1.28izrwwy0w74.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-30</div><div class="title">選擇權簡介</div></div></a></div></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 評論</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://raw.githubusercontent.com/opsuperman/picx-images-hosting/master/main_website/icon_110110.webp" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">OptionSuperman</div><div class="author-info__description">選擇權程式交易分享</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">3</div></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://bit.ly/3Swrkbh">加入討論社群</a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目錄</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A4%94%E6%AD%B7%E5%8F%B2%E8%B3%87%E6%96%99%E7%BC%BA%E5%A4%B1%E5%95%8F%E9%A1%8C"><span class="toc-number">1.</span> <span class="toc-text">🤔歷史資料缺失問題</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%81%B8%E6%93%87%E6%AC%8A%E7%AD%96%E7%95%A5%E6%A1%88%E4%BE%8B"><span class="toc-number">2.</span> <span class="toc-text">選擇權策略案例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%BA%E8%AB%87%E8%A3%9C%E9%81%B8%E6%93%87%E6%AC%8A%E5%83%B9%E6%A0%BC%E7%BC%BA%E5%80%BC%E6%96%B9%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text">淺談補選擇權價格缺值方法:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E4%BF%AE%E6%AD%A3%E9%80%99%E4%BA%9B%E7%BC%BA%E5%8F%A3%EF%BC%9F%E7%AD%94%E6%A1%88%E5%8F%AF%E8%83%BD%E8%A6%81%E5%BE%9E%E9%9A%B1%E5%90%AB%E6%B3%A2%E5%8B%95%E7%8E%87%E5%92%8C%E9%81%B8%E6%93%87%E6%AC%8A%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%96%B9%E6%B3%95%E8%91%97%E6%89%8B"><span class="toc-number">3.1.</span> <span class="toc-text">如何修正這些缺口？答案可能要從隱含波動率和選擇權模型的方法著手</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8D%E4%BC%B0%E8%A8%88%E5%80%BC%E7%9A%84%E7%90%86%E8%A7%A3"><span class="toc-number">3.2.</span> <span class="toc-text">對估計值的理解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%A6%E7%94%A8%E5%B7%A5%E5%85%B7-%E9%81%B8%E6%93%87%E6%AC%8A%E8%B6%85%E4%BA%BA%E5%9B%9E%E6%B8%AC%E5%B9%B3%E5%8F%B0"><span class="toc-number">4.</span> <span class="toc-text">實用工具-選擇權超人回測平台</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%8C%E9%81%B8%E6%93%87%E6%AC%8A%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E8%A6%81%E9%BB%9E%EF%BC%9A"><span class="toc-number">5.</span> <span class="toc-text">📌選擇權策略開發要點：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%81%BF%E9%96%8B%E4%B8%8B%E5%8D%88%E5%89%9B%E9%96%8B%E7%9B%A4"><span class="toc-number">5.1.</span> <span class="toc-text">1.避開下午剛開盤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%B8%8D%E8%A6%81%E4%BD%BF%E7%94%A8%E5%A4%AA%E5%A4%9A%E6%B7%B1%E5%83%B9%E5%85%A7%E6%88%96%E6%B7%B1%E5%83%B9%E5%A4%96"><span class="toc-number">5.2.</span> <span class="toc-text">2.不要使用太多深價內或深價外</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%B3%A8%E6%84%8F%E4%BD%BF%E7%94%A8%E4%BC%B0%E8%A8%88%E5%80%BC%E7%9A%84%E6%AF%94%E4%BE%8B%E8%88%87%E5%AE%8C%E5%85%A8%E7%BC%BA%E5%A4%B1%E7%9A%84%E6%AF%94%E4%BE%8B"><span class="toc-number">5.3.</span> <span class="toc-text">3.注意使用估計值的比例與完全缺失的比例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%B7%E5%8F%B2%E5%9B%9E%E6%B8%AC%E7%9A%84%E6%96%B0%E7%90%86%E8%A7%A3-%E7%90%86%E8%AB%96%E5%83%B9%E6%A0%BC%E7%9A%84%E8%97%9D%E8%A1%93%E8%88%87%E7%A7%91%E5%AD%B8"><span class="toc-number">6.</span> <span class="toc-text">歷史回測的新理解-理論價格的藝術與科學</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B8%BD%E7%B5%90"><span class="toc-number">7.</span> <span class="toc-text">總結:</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/just-buy-call/" title="簡單長期Buy Call策略分析"><img src="https://github.com/opsuperman/picx-images-hosting/raw/master/簡單長期Buy-Call策略分析/封面.22948brzik1s.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="簡單長期Buy Call策略分析"></a><div class="content"><a class="title" href="/posts/just-buy-call/" title="簡單長期Buy Call策略分析">簡單長期Buy Call策略分析</a><time datetime="2023-11-28T08:13:00.000Z" title="發表於 2023-11-28 16:13:00">2023-11-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/option-historical-prices-problem/" title="選擇權策略開發-缺乏歷史價格的挑戰"><img src="https://github.com/opsuperman/picx-images-hosting/raw/master/選擇權策略開發-缺乏歷史價格的挑戰/歷史價格警示.j1ityqv1y2w.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="選擇權策略開發-缺乏歷史價格的挑戰"></a><div class="content"><a class="title" href="/posts/option-historical-prices-problem/" title="選擇權策略開發-缺乏歷史價格的挑戰">選擇權策略開發-缺乏歷史價格的挑戰</a><time datetime="2023-10-26T09:57:00.000Z" title="發表於 2023-10-26 17:57:00">2023-10-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/options-trading-backtesting-guide/" title="如何程式交易選擇權-回測篇"><img src="https://github.com/opsuperman/picx-images-hosting/raw/master/如何程式交易選擇權/回測選擇權的機器人工具.qiff3jnwb1s.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="如何程式交易選擇權-回測篇"></a><div class="content"><a class="title" href="/posts/options-trading-backtesting-guide/" title="如何程式交易選擇權-回測篇">如何程式交易選擇權-回測篇</a><time datetime="2023-04-25T04:34:00.000Z" title="發表於 2023-04-25 12:34:00">2023-04-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/1564230905/" title="現貨，期貨，與選擇權差別"><img src="https://raw.githubusercontent.com/opsuperman/picx-images-hosting/master/現貨期貨選擇權差別/第一章圖.9ali0ml7n9w.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="現貨，期貨，與選擇權差別"></a><div class="content"><a class="title" href="/posts/1564230905/" title="現貨，期貨，與選擇權差別">現貨，期貨，與選擇權差別</a><time datetime="2023-04-06T04:14:00.000Z" title="發表於 2023-04-06 12:14:00">2023-04-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/3742663632/" title="選擇權履約價種類"><img src="https://raw.githubusercontent.com/opsuperman/picx-images-hosting/master/履約價種類/workspace-gb3c1af57c_1920.7715chvcyuc0.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="選擇權履約價種類"></a><div class="content"><a class="title" href="/posts/3742663632/" title="選擇權履約價種類">選擇權履約價種類</a><time datetime="2023-03-30T17:54:00.000Z" title="發表於 2023-03-31 01:54:00">2023-03-31</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By OptionSuperman</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主題 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="閱讀模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="淺色和深色模式轉換"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="單欄和雙欄切換"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="設定"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目錄"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直達評論"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="返回頂部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(()=>{const t=function(){this.page.url="https://blog.optionsuperman.com/posts/option-historical-prices-problem/",this.page.identifier="/posts/option-historical-prices-problem/",this.page.title="選擇權策略開發-缺乏歷史價格的挑戰"},e=()=>{window.DISQUS&&window.DISQUS.reset({reload:!0,config:t})};btf.addGlobalFn("themeChange",e,"disqus");const o=()=>{if(window.DISQUS)e();else{const t=document.createElement("script");t.src="https://blog-optionsuperman.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),document.head.appendChild(t)}};o()})()</script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜尋</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 資料庫載入中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜尋文章" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>